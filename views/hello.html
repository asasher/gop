<html>
	<head>
		<title>GOP</title>
		<link href='http://fonts.googleapis.com/css?family=Lato&subset=latin,latin-ext' rel='stylesheet' type='text/css'>
		<style>
			* {
				box-sizing: border-box;
			}
			html, body {
				position: relative;
				background-color: #31313A;
			}
			pre {
				color: #fff;
			}
			svg {
				width: 100%;
				height: 100%;
			}
			.node {
				fill: #fff;
				stroke: #fff;
				stroke-width: 1.5px;
			}
			.label {
				font-family: 'Lato';
				font-size: 0.8em;
				fill: #fff;
			}
			.link {
				stroke-width: 1;
				stroke: #fff;
				stroke-opacity: .6;
			}
		</style>
	</head>
	<body>
	</body>
	<script>
		var graph = {% autoescape false %}{{ data }}{% endautoescape %};
		console.log(data);
	</script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
	<script>
	
	var width = 960,
		height = 500;
	
	var color = d3.scale.category20();
	
	var force = d3.layout.force()
		.charge(-120)
		.linkDistance(30)
		.size([width, height]);
	
	var svg = d3.select('body').append('svg')
		.attr('viewBox', '0 0 ' + width + ' ' + height )
        .attr('preserveAspectRatio', 'xMidYMid meet');
			
	force.nodes(graph.nodes)
		.links(graph.links)
		.start();
		
	function linkId(d, i) {
		return 'link-' + i;		
	}
	
	var link = svg.selectAll('.link')
		.data(graph.links)
		.enter()
		.append('path')
		.attr('id', linkId)
		.attr('class', 'link');
		
	var node = svg.selectAll('.node')
		.data(graph.nodes)
		.enter()
		.append('circle')
		.attr('class', 'node')
		.attr('r', 5)
		.call(force.drag);
		
	var labels = svg.selectAll(".label")
		.data(graph.links)
		.enter()
		.append('text')
		.attr('class','label')
		.attr('dx',20)
		.attr('dy',0)
		.append("textPath")
		.attr("xlink:href",function(d,i) {
			return '#' + linkId(d,i);
		})
		.text(function(d,i) { return d.text;});
	
	force.on('tick', function() {
		link.attr('d', function(d) {
			return 'M' + d.source.x + ',' + d.source.y + 'L' + d.target.x + ',' + d.target.y;
		});	
	
		node.attr("cx", function(d) { return d.x; })
        	.attr("cy", function(d) { return d.y; });
	});	
	</script>
</html>